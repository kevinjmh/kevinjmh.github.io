
 <!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
    <title>Day 1 to Carbondata | Manhua</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Manhua">
    

    
    <meta name="description" content="What is carbonCarbondata is an indexed columnar data format for fast analytics on big data platform, like parquet, orc. Reference Site Official Site Github Doc cwiki Pony Mail User mail list Dev mail">
<meta property="og:type" content="article">
<meta property="og:title" content="Day 1 to Carbondata">
<meta property="og:url" content="http://kevinjmh.github.io/2021/04/09/Doc/carbon/1_carbon/index.html">
<meta property="og:site_name" content="Manhua">
<meta property="og:description" content="What is carbonCarbondata is an indexed columnar data format for fast analytics on big data platform, like parquet, orc. Reference Site Official Site Github Doc cwiki Pony Mail User mail list Dev mail">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-04-09T20:15:10.000Z">
<meta property="article:modified_time" content="2023-10-18T09:31:22.956Z">
<meta property="article:author" content="Manhua">
<meta property="article:tag" content="carbondata">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@jiangmanhua">

    
    <link rel="alternative" href="/atom.xml" title="Manhua" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.0.0"></head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="Manhua" title="Manhua"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Manhua">Manhua</a></h1>
				<h2 class="blog-motto">Never Say Die</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页 | Home</a></li>
					
						<li><a href="/archives">归档 | Archives</a></li>
					
						<li><a href="/about">简介 | About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:kevinjmh.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/04/09/Doc/carbon/1_carbon/" title="Day 1 to Carbondata" itemprop="url">Day 1 to Carbondata</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Manhua" target="_blank" itemprop="author">Manhua</a>
		
  <p class="article-time">
    <time datetime="2021-04-09T20:15:10.000Z" itemprop="datePublished"> Published 2021-04-09</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#What-is-carbon"><span class="toc-number">1.</span> <span class="toc-text">What is carbon</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference-Site"><span class="toc-number">1.1.</span> <span class="toc-text">Reference Site</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Run-Carbondata-on-your-computer"><span class="toc-number">2.</span> <span class="toc-text">Run Carbondata on your computer</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Get-Carbondata-Release"><span class="toc-number">2.1.</span> <span class="toc-text">1. Get Carbondata Release</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Prepare-environment"><span class="toc-number">2.2.</span> <span class="toc-text">2. Prepare environment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Run-Carbon"><span class="toc-number">2.3.</span> <span class="toc-text">3. Run Carbon</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Use-Carbon-to-manage-your-data"><span class="toc-number">2.4.</span> <span class="toc-text">Use Carbon to manage your data</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Build-Carbondata-yourself"><span class="toc-number">3.</span> <span class="toc-text">Build Carbondata yourself</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Prepare-develop-environment"><span class="toc-number">3.1.</span> <span class="toc-text">Prepare develop environment</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Maven"><span class="toc-number">3.1.1.</span> <span class="toc-text">Maven</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Git"><span class="toc-number">3.1.2.</span> <span class="toc-text">Git</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build"><span class="toc-number">3.2.</span> <span class="toc-text">Build</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Test"><span class="toc-number">3.3.</span> <span class="toc-text">Test</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Contribute-to-community"><span class="toc-number">4.</span> <span class="toc-text">Contribute to community</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Discuss-in-maillist"><span class="toc-number">4.1.</span> <span class="toc-text">1. Discuss in maillist</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Contribute-codes"><span class="toc-number">4.2.</span> <span class="toc-text">2. Contribute codes</span></a></li></ol></li></ol>
		
		</div>
		
		<h1 id="What-is-carbon"><a href="#What-is-carbon" class="headerlink" title="What is carbon"></a>What is carbon</h1><p><a target="_blank" rel="noopener" href="http://carbondata.apache.org/">Carbondata</a> is an indexed columnar data format for fast analytics on big data platform, like parquet, orc.</p>
<h2 id="Reference-Site"><a href="#Reference-Site" class="headerlink" title="Reference Site"></a>Reference Site</h2><ul>
<li><a target="_blank" rel="noopener" href="http://carbondata.apache.org/">Official Site</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/apache/carbondata">Github</a></li>
<li><a target="_blank" rel="noopener" href="http://carbondata.apache.org/documentation.html">Doc</a></li>
<li><a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/CARBONDATA/">cwiki</a></li>
<li><a target="_blank" rel="noopener" href="https://lists.apache.org/list.html?carbondata.apache.org">Pony Mail</a></li>
<li><a target="_blank" rel="noopener" href="http://apache-carbondata-user-mailing-list.3231.n8.nabble.com/">User mail list</a></li>
<li><a target="_blank" rel="noopener" href="http://apache-carbondata-mailing-list-archive.1130556.n5.nabble.com/">Dev mail list</a></li>
<li><a target="_blank" rel="noopener" href="https://issues.apache.org/jira/browse/CARBONDATA">JIRA</a></li>
</ul>
<h1 id="Run-Carbondata-on-your-computer"><a href="#Run-Carbondata-on-your-computer" class="headerlink" title="Run Carbondata on your computer"></a>Run Carbondata on your computer</h1><h2 id="1-Get-Carbondata-Release"><a href="#1-Get-Carbondata-Release" class="headerlink" title="1. Get Carbondata Release"></a>1. Get Carbondata Release</h2><p>You can get released Carbondata jar from <a target="_blank" rel="noopener" href="https://github.com/apache/carbondata/releases">Github</a> or <a target="_blank" rel="noopener" href="https://dist.apache.org/repos/dist/release/carbondata/">Apache achieve</a>. </p>
<p>As for each module, you can find it in <a target="_blank" rel="noopener" href="https://search.maven.org/search?q=g:org.apache.carbondata">maven repository</a></p>
<h2 id="2-Prepare-environment"><a href="#2-Prepare-environment" class="headerlink" title="2. Prepare environment"></a>2. Prepare environment</h2><p>Recommand:</p>
<ul>
<li>Linux OS</li>
<li>JDK 7</li>
<li>Hadoop 2.7.2</li>
<li>Spark 2.3</li>
</ul>
<p>Please ensure that HDFS, MapReduce and Spark is working normally. You can check it by running example job, such as <code>Word Count</code> for MapReduce and <code>PI calculation</code> for Spark.</p>
<p>Also, you need to prepare <code>carbon.properties</code> file as <code>https://github.com/apache/carbondata/tree/master/conf/carbon.properties.template</code></p>
<p>You can config <code>carbon.properties.filepath</code> in spark’s  <code>spark-defaults.conf</code> file, or set <code>extraJavaOptions</code> when submit application.<br>Please ensure <code>carbon.properties</code> file can be distributed to each executor, else parameters will not take effect.</p>
<h2 id="3-Run-Carbon"><a href="#3-Run-Carbon" class="headerlink" title="3. Run Carbon"></a>3. Run Carbon</h2><p>We can submit the assembly jar file as a spark application to create <code>CarbonThriftServer</code>, and then use <code>beeline</code> to connect.</p>
<blockquote>
<p>Template</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">./bin/spark-submit \</span><br><span class="line">  --class org.apache.carbondata.spark.thriftserver.CarbonThriftServer  \</span><br><span class="line">  --master &lt;master-url&gt; \</span><br><span class="line">  --deploy-mode &lt;deploy-mode&gt; \</span><br><span class="line">  --conf &lt;key&gt;=&lt;value&gt; \</span><br><span class="line">  ... # other options</span><br><span class="line">  &lt;CARBON_ASSEMBLY_JAR_PATH&gt; \</span><br><span class="line">  &lt;CARBON_STORE_PATH&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Example</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$SPARK_HOME/bin/spark-submit \</span><br><span class="line">  --class org.apache.carbondata.spark.thriftserver.CarbonThriftServer  \</span><br><span class="line">  --master yarn \</span><br><span class="line">  --deploy-mode client \</span><br><span class="line">  --driver-memory 10g \</span><br><span class="line">  --num-executors 3 \</span><br><span class="line">  --executor-memory 10g \ </span><br><span class="line">  --executor-cores 10 \</span><br><span class="line">  --conf -Dcarbon.properties.filepath = carbon.properties \</span><br><span class="line">  apache-carbondata-1.5.1-bin-spark2.2.1-hadoop2.7.2.jar \</span><br><span class="line">  hdfs://localhost:9000/user/hive/warehouse/carbon.store</span><br></pre></td></tr></table></figure>

<p>When you see a log saying that Thrift Sever is listening to 127.0.0.1:10000, you can use following command to connect:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$SPARK_HOME/bin/beeline -u jdbc:hive2://localhost:10000 -n root</span><br></pre></td></tr></table></figure>

<h2 id="Use-Carbon-to-manage-your-data"><a href="#Use-Carbon-to-manage-your-data" class="headerlink" title="Use Carbon to manage your data"></a>Use Carbon to manage your data</h2><p>Simple usage example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// create table</span><br><span class="line">CREATE TABLE IF NOT EXISTS carbon_test_table (col_1 string , col_2 int)</span><br><span class="line">STORED AS carbondata;</span><br><span class="line"></span><br><span class="line">// show table </span><br><span class="line">SHOW TABLES;</span><br><span class="line"></span><br><span class="line">// insert data</span><br><span class="line">INSERT INTO TABLE carbon_test_table VALUES(&#x27;a&#x27;,1),(&#x27;b&#x27;,2);</span><br><span class="line"></span><br><span class="line">// show segments</span><br><span class="line">SHOW SEGMENTS FOR TABLE carbon_test_table;</span><br><span class="line"></span><br><span class="line">// query</span><br><span class="line">SELECT * FROM carbon_test_table WHERE col_2=1;</span><br></pre></td></tr></table></figure>

<p>And you can check data file in <CARBON_STORE_PATH> which is set when you start CarbonThriftServer</p>
<h1 id="Build-Carbondata-yourself"><a href="#Build-Carbondata-yourself" class="headerlink" title="Build Carbondata yourself"></a>Build Carbondata yourself</h1><p>Once you modify source code, you need to build jar for testing.</p>
<h2 id="Prepare-develop-environment"><a href="#Prepare-develop-environment" class="headerlink" title="Prepare develop environment"></a>Prepare develop environment</h2><p>Recommand:</p>
<ul>
<li>Linux OS</li>
<li>JDK 7/8</li>
<li>Maven</li>
<li>Git</li>
<li>Thrift 0.9.3</li>
<li>IntelliJ IDEA</li>
</ul>
<h3 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h3><p>Config a mirror for fetching dependencies jars</p>
<p>For missing jars, you can use <code>mvn install</code> command to install to your local repository</p>
<h3 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h3><p>Clone Carbondata project from Apache github repository. Recommand to fork the project to your own github accout and clone.</p>
<h2 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -DskipTests -Pspark-2.2 -Dspark.version=2.2.1 clean package</span><br></pre></td></tr></table></figure>

<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><p>Submit the jar file you built and run.</p>
<h1 id="Contribute-to-community"><a href="#Contribute-to-community" class="headerlink" title="Contribute to community"></a>Contribute to community</h1><p>We are glad you share your changes to all other users to make carbondata better.</p>
<h2 id="1-Discuss-in-maillist"><a href="#1-Discuss-in-maillist" class="headerlink" title="1. Discuss in maillist"></a>1. Discuss in maillist</h2><p>Raise your problem/idea in maill list to make your work more efficiency. </p>
<h2 id="2-Contribute-codes"><a href="#2-Contribute-codes" class="headerlink" title="2. Contribute codes"></a>2. Contribute codes</h2><p>If you have fixed a bug or optimized Carbondata’s code, you can create a JIRA ticket for tracking and create a PR(pull request) in Github</p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/BigData/">BigData</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/carbondata/">carbondata</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://kevinjmh.github.io/2021/04/09/Doc/carbon/1_carbon/" data-title="Day 1 to Carbondata | Manhua" data-tsina="" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2021/04/10/Doc/RDMA/" title="RDMA">
  <strong>上一篇：</strong><br/>
  <span>
  RDMA</span>
</a>
</div>


<div class="next">
<a href="/2021/04/09/Doc/carbon/pr/"  title="Carbondata PR">
 <strong>下一篇：</strong><br/> 
 <span>Carbondata PR
</span>
</a>
</div>

</nav>

	

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github Card</p>
<div class="github-card" data-github="kevinjmh" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/Application/" title="Application">Application<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/BigData/" title="BigData">BigData<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/CheatSheet/" title="CheatSheet">CheatSheet<sup>21</sup></a></li>
		  
		
		  
			<li><a href="/categories/Info/" title="Info">Info<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/慢话/" title="慢话">慢话<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/carbondata/" title="carbondata">carbondata<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/project/" title="project">project<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/rdma/" title="rdma">rdma<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/software/" title="software">software<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/recommendation/" title="recommendation">recommendation<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/docker/" title="docker">docker<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/markdown/" title="markdown">markdown<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/carbon/" title="carbon">carbon<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/spark/" title="spark">spark<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/hadoop/" title="hadoop">hadoop<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="http://www.cnblogs.com/manhua" target="_blank" title="cnBlogs">cnBlogs</a>
            
          </li>
        
    </ul>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Manhua Jiang. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/443181876" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/kevinjmh" target="_blank" class="icon-github" title="github"></a>
		
		
		
		<a href="https://twitter.com/jiangmanhua" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		<a href="https://www.facebook.com/jiangmanhua" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2023 
		
		<a href="/about" target="_blank" title="Manhua">Manhua</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
        getSize();
        if (myWidth >= 1024) {
          c.click();
        }
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
